<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fee mechanism :: Starknet documentation</title>
    <link rel="canonical" href="https://docs.starknet.io/architecture-and-concepts/network-architecture/fee-mechanism/">
    <link rel="prev" href="../data-availability/">
    <link rel="next" href="../messaging-mechanism/">
    <meta name="generator" content="Antora 3.1.1">


    <!-- Primary Meta Tags -->
    <meta name="title" content="Starknet Documentation">
    <meta name="description" content="Reference documentation for developers building on Starknet.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://docs.starknet.io/">
    <meta property="og:title" content="Starknet Documentation">
    <meta property="og:description" content="Reference documentation for developers building on Starknet.">
    <meta property="og:image" content="https://www.starknet.io/starknet-docs-card.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://docs.starknet.io/">
    <meta property="twitter:title" content="Starknet Documentation">
    <meta property="twitter:description" content="Reference documentation for developers building on Starknet.">
    <meta property="twitter:image" content="https://www.starknet.io/starknet-docs-card.png">  <link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
  <link id="theme" rel="stylesheet" title="Default" href="../../../_/css/site.css?new">
  <link rel="stylesheet" title="Dark" href="../../../_/css/dark-site.css?new">
  <link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
  <link rel="stylesheet" href="../../../_/css/home.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WY42TERK5P"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-WY42TERK5P')</script>
    <script>var uiRootPath = '../../../_'</script>
    <script src="../../../_/js/vendor/medium-zoom.js?new"></script>
    <script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
        (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3529885,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
        })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
<link rel="icon" href="../../../_/img/favicon/favicon.ico" type="image/x-icon">

<!-- For all browsers -->
<link rel="icon" type="image/png" sizes="32x32" href="../../../_/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../_/img/favicon-16x16.png">

<!-- For Google and Chrome -->
<link rel="icon" type="image/png" sizes="192x192" href="../../../_/img/favicon/android-chrome-192x192.png">

<!-- For iPad -->
<link rel="apple-touch-icon" type="image/png" sizes="167x167" href="../../../_/img/favicon/apple-touch-icon.png">
<!-- For iPhone -->
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../../_/img/favicon/apple-touch-icon.png">  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../.." class="starknet-logo"></a>
        <div class="vertical-divider desktop-only"></div>
        <a href="../../.." class="docs-logo desktop-only">Docs</a>
      </div>
      <!--<a class="navbar-item" href="https://docs.starknet.io">Starknet documentation</a>-->
      <div id="autocomplete" class="autocomplete-root"></div>
      <div class="header-right">
        <div class="theme-toggle-container mobile-only">
          <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle"></button>
        </div>
        <button class="navbar-burger" data-target="topbar-nav">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
    
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <a class="navbar-link" href="https://starknet.io/" target="_blank">Starknet Home</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link" href="https://starknet.io/building-on-starknet/tutorials/" target="_blank">Tutorials</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link" href="https://twitter.com/@Starknet" target="_blank">Twitter</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link" href="https://starknet.io/discord" target="_blank">Discord</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link" href="https://github.com/starknet-io/starknet-docs" target="_blank">GitHub</a>
        </div>
        <div class="theme-toggle-container">
          <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        </div>
      </div>
    </div>
  </nav>
</header><div class="toolbar" role="navigation">
  <span></span>
  <span></span>
  <a href="../../../" class="home-link mask-svg-center"></a>
  <div id="mobile-autocomplete" class="mobile-only"></div>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li>Concepts &amp; Components</li>
    <li><a href="./">Fee mechanism</a></li>
  </ul>
</nav>
  <div class="edit-this-page">
    <a href='https://github.com/starknet-io/starknet-docs/issues/new?assignees=landauraz&title=Feedback for "Fee mechanism"' target="_blank"><img class="heart">Share feedback</a>
  </div>
  <div class="edit-this-page">
    <a href="https://github.com/starknet-io/starknet-docs/edit/main/components/Starknet/modules/architecture-and-concepts/pages/network-architecture/fee-mechanism.adoc" target="_blank"><img class="pencil">Edit content</a>
  </div>
</div>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../">Starknet</a></h3>
<ul class="nav-list">
<li class="nav-item parent" data-depth="0">    <ul class="nav-list">
<li class="nav-item is-active parent" data-depth="1">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../../../">Overview</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Quick start</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#environment-setup.adoc">Setting up your environment</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#set-up-an-account.adoc">Setting up an account</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#declare-a-smart-contract.adoc">Declaring a smart contract</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#deploy-a-smart-contract.adoc">Deploying a smart contract</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#interact-with-a-smart-contract.adoc">Interacting with a smart contract</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#using_devnet.adoc">Using a development network</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
<li class="nav-item parent" data-depth="0">    <ul class="nav-list">
<li class="nav-item is-active parent" data-depth="1">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Concepts &amp; Components</span>
<ul class="nav-list">
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Accounts</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../accounts/introduction/">What is an account?</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../accounts/approach/">Starknet&#8217;s account interface</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../accounts/account-functions/">Account interface function reference</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../accounts/deploying-new-accounts/">Deploying new accounts</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../accounts/universal-deployer/">Universal Deployer Contract</a>
  </li>
</ul>
  </li>
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../block-structure/">Block structure</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Contracts</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/contract-classes/">Contract classes and instances</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/class-hash/">Class hash</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/compiled-class-hash/">Compiled class hash</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/contract-address/">Contract address</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/contract-storage/">Contract storage</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/contract-abi/">Contract ABI</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/cairo-and-sierra/">Cairo and Sierra</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/cairo-builtins/">Cairo builtins</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/serialization-of-cairo-types/">Serialization of Cairo types</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/system-calls-cairo1/">System calls</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../smart-contracts/execution-info/">Execution information for the current block</a>
  </li>
</ul>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Cryptography</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../cryptography/p-value/">The STARK field</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../cryptography/stark-curve/">The STARK curve</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../cryptography/hash-functions/">Hash functions</a>
  </li>
</ul>
  </li>
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../data-availability/">Data availability</a>
  </li>
<li class="nav-item is-current-page" data-depth="2">    
    <a 
       class="nav-link"
     href="./">Fee mechanism</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">L1-L2 messaging</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../messaging-mechanism/">L1-L2 messaging mechanism</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../messaging-reference/">L1-L2 Messaging reference</a>
  </li>
</ul>
  </li>
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../os/">Operating system</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Staking</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../../staking/overview/">Overview</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../../staking/architecture/">Architecture</a>
  </li>
<li class="nav-item parent" data-depth="3">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Procedures</span>
<ul class="nav-list">
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/entering-staking/">Becoming a Validator</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/increasing-staking/">Increasing Stake</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/claiming-rewards/">Claiming Rewards</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/delegating-stake/">Delegating Stake</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/switching-delegation-pools/">Switching Delegation Pools</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/exiting-staking/">Exiting the Staking Protocol</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/managing-staking-and-delegation-operations/">Managing Staking and Delegation Operations</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../staking/staking-events-and-read-functions/">Staking Events and Read Functions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../starknet-state/">State</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">StarkGate</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../../starkgate/overview/">Overview</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../../starkgate/architecture/">Architecture</a>
  </li>
<li class="nav-item parent" data-depth="3">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Procedures</span>
<ul class="nav-list">
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../starkgate/depositing/">Depositing funds</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../starkgate/withdrawing/">Withdrawing funds</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../starkgate/automated-actions-with-bridging/">Performing a Smart Deposit</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../starkgate/adding-a-token/">Adding a token</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../starkgate/cancelling-a-deposit/">Cancelling a deposit</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="../../../starkgate/estimating-fees/">Estimating StarkGate fees</a>
  </li>
<li class="nav-item" data-depth="4">    
    <a 
       class="nav-link"
     href="#dai-token-migration.adoc">Migrating DAI v0 to DAI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../../economics-of-starknet/">Tokenomics</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Transactions</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../transaction-life-cycle/">Transaction lifecycle</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../transactions/">Transaction types</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
<li class="nav-item parent" data-depth="0">    <ul class="nav-list">
<li class="nav-item is-active parent" data-depth="1">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Resources &amp; References</span>
<ul class="nav-list">
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="../../../glossary/">Glossary</a>
  </li>
<li class="nav-item" data-depth="2">    
    <a 
       class="nav-link"
     href="#compatibility.adoc">Compatibility tables</a>
  </li>
<li class="nav-item parent" data-depth="2">    
    <button class="nav-item-toggle mask-svg-center"></button>
    <span class="nav-text">Release information</span>
<ul class="nav-list">
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../../tools/limits-and-triggers/">Current versions and limits</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#deprecated.adoc">Deprecated, unsupported, and removed features</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="../../../tools/important-addresses/">Important addresses</a>
  </li>
<li class="nav-item" data-depth="3">    
    <a 
       class="nav-link"
     href="#version-notes.adoc">Release notes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
    <div class="navbar-end mobile-only">
      <div class="hr-divider"></div>
      <div class="navbar-item-flex">
        <a class="navbar-link" href="https://starknet.io/" target="_blank">Starknet Home</a>
        <a class="link-icon" href="https://starknet.io/" target="_blank"></a>
      </div>
      <div class="navbar-item-flex">
        <a class="navbar-link" href="https://starknet.io/building-on-starknet/tutorials/" target="_blank">Tutorials</a>
        <a class="link-icon" href="https://starknet.io/building-on-starknet/tutorials/" target="_blank"></a>
      </div>
    </div>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Fee mechanism</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section describes fees that are paid on L2 starting in Starknet 0.13.0. For information about messaging fees that are paid on L1, see <a href="../messaging-mechanism/#l1-l2-message-fees" class="xref page">L1 → L2 message fees</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what_do_we_pay_for"><a class="anchor" href="#what_do_we_pay_for"></a>What do we price?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At the time of writing, the following components are contributing to the transaction fee:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#computation_without_builtins">Computational complexity</a>: The marginal cost of verifying the transaction on L1, measured in L1 gas.</p>
</li>
<li>
<p><a href="#onchain_data_components">Onchain data</a>: The cost of posting  the state diffs induced by the transaction to L1 (for more details, see <a href="../data-availability/" class="xref page">data availability</a>). This is measured in L1 gas or L1 data gas, depending on whether or not the L2 block in which the transaction was included uses calldata or blobs.</p>
</li>
<li>
<p>L2→L1 messages: Messages sent to L1 are eventually sent to the Starknet core contract as L1 calldata by the sequencer; therefore L2 transaction that send L2&#8594;L1 messages incur an additional L1 gas cost.</p>
</li>
<li>
<p>L2 calldata, events and code: From Starknet 0.13.1 onwards, there is a per-byte (or per felt) price for L2 payloads. For more details, see <a href="#l2_calldata">L2 payloads</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="when_is_the_fee_charged"><a class="anchor" href="#when_is_the_fee_charged"></a>When is the fee charged?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fee is charged atomically with the transaction execution on L2. The Starknet OS injects a transfer of the fee-related ERC-20, with an amount equal to the fee paid, the sender equal to the transaction submitter, and the sequencer as a receiver.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fee_units"><a class="anchor" href="#fee_units"></a>Fee units</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each transaction is associated with an estimate of the amount of gas used. Combining this estimate with the price of gas yields the estimated fee.</p>
</div>
<div class="paragraph">
<p>For transactions prior to v3, the fee is denominated in WEI. For transactions v3 and later, the fee is denominated in STRK.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fee_limitations"><a class="anchor" href="#fee_limitations"></a>Transaction Fee limits</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="v3_fee_limitations"><a class="anchor" href="#v3_fee_limitations"></a>v3 transactions</h3>
<div class="paragraph">
<p>With v3 transactions, users specify the max amount and max price for each resource. At the time of writing, the only available resource is L1 gas. In the future, we will introduce L2 gas which will be used to price L2 work (as opposed to only charging for the proof verification in L1 gas, which is what happens today).</p>
</div>
</div>
<div class="sect2">
<h3 id="deprecated_fee_limitations"><a class="anchor" href="#deprecated_fee_limitations"></a>Deprecated transactions (version &lt; 3)</h3>
<div class="paragraph">
<p>With older transaction versions, users specify the maximum fee that they are willing to pay for a transaction.</p>
</div>
<div class="paragraph">
<p>The only limitation on the sequencer, which is enforced by the Starknet OS, is that the actual fee charged is bounded by <code>max_fee</code>. While not enforced in the proof, the Starknet sequencer usually charges less than <code>max_fee</code>, as it charges in accordance with the above fee formula.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="v3-fee-estimation"><a class="anchor" href="#v3-fee-estimation"></a>Estimating fees</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fee of transactions can be estimated with using <code>starknet_estimateFee</code> API call, which is part of Starknet&#8217;s API v0.7.0 and above. For more information, see the <a href="https://github.com/starkware-libs/starknet-specs/blob/v0.7.1/api/starknet_api_openrpc.json#L612">Starknet JSON RPC specification</a>. For more information on how to construct the appropriate <code>resource_bounds</code> based on the response of <code>starknet_estimateFee</code>, see <a href="https://community.starknet.io/t/starknet-v0-13-1-pre-release-notes/113664#sdkswallets-how-to-use-the-new-fee-estimates-7">How to use the new fee estimates?</a> on the Starknet community forum.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fee_calculation"><a class="anchor" href="#fee_calculation"></a>Fee calculation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overall_fee"><a class="anchor" href="#overall_fee"></a>Overall</h3>
<div class="paragraph">
<p>This section shows the formula for determining a transaction&#8217;s fee. The following sections describe how this formula was derived.</p>
</div>
<div class="sect3">
<h4 id="blobs-vs-calldata"><a class="anchor" href="#blobs-vs-calldata"></a>Blobs vs. calldata</h4>
<div class="paragraph">
<p>Starting with Starknet v0.13.1, Starknet distinguishes between blocks whose state diffs are sent to L1 as calldata and blocks whose state diffs are sent to L1 as blobs. The <code>l1_da_mode</code> property in the Starknet block header contains this information. The cost of computation remains the same on both options, but the cost related to data availability differs.</p>
</div>
</div>
<div class="sect3">
<h4 id="overall_fee_blob"><a class="anchor" href="#overall_fee_blob"></a>Overall fee with blobs</h4>
<div class="paragraph">
<p>The following formula describes the overall fee, \(F\), for a transaction in blocks whose state diffs are sent to L1 as blobs:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
F  = \; &amp; gas\_price \cdot \Bigg(\max_k v_k w_k + \\
&amp; \quad + \; \text{message_calldata_cost}\cdot 3t + (\text{message_calldata_cost} + \text{l1_log_data_cost})\cdot \sum\limits_{i=1}^t q_i \; + \\
&amp; \quad + \; \left(\text{l1_storage_write_cost}+\text{log_message_to_l1_cost}\right)\cdot t + \; \\
&amp; \quad + \; \text{l2_payload_costs}\Bigg) + \\
&amp; data\_gas\_price\cdot\text{felt_size_in_bytes}\cdot\bigg(2(n-1)+2(m-1) + \ell +2D \bigg)
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(v\) is a vector that represents resource usage, where each of its entries, \(v_k\), corresponds to different resource types: Cairo steps and number of applications of each builtin.</p>
<div class="paragraph">
<p>For more information see <a href="#calculation_of_computation_costs">Calculation of computation costs</a>.</p>
</div>
</li>
<li>
<p>\(w\) is the <a href="#calculation_of_computation_costs"><code>CairoResourceFeeWeights</code></a> vector.</p>
</li>
<li>
<p>\(n\) is <a href="#storage_updates">the number of unique contracts updated</a>, which also includes changes to classes of existing contracts and contract deployments, even if the storage of the newly deployed contract is untouched. In other words, \(n\ge\ell\). Notice that \(n\ge 1\) always holds, because the fee token contract is always updated, which does not incur any fee.</p>
</li>
<li>
<p>\(m\) is the number of values updated, not counting multiple updates for the same key. Notice that \(m\ge 1\) always holds, because the sequencer&#8217;s balance is always updated, which does not incur any fee.</p>
</li>
<li>
<p>\(t\) is the number of L2&#8594;L1 messages sent, where the corresponding payload sizes are denoted by \(q_1,...,q_t\).</p>
</li>
<li>
<p>\(\ell\) is the number of contracts whose class was changed, which happens on contract deployment and when applying the <code>replace_class</code> syscall.</p>
</li>
<li>
<p>\(D\) is 1 if the transaction is of type <code>DECLARE</code> and 0 otherwise. Declare transactions need to post on L1 the new class hash and compiled class hash which are added to the state.</p>
</li>
<li>
<p>L2&#8594;L1 messaging constants:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>\(\text{message_calldata_cost}\) is 1124 gas per 32-byte word.</p>
</li>
<li>
<p>\(\text{l1_log_data_cost}\) is 256 gas.</p>
</li>
<li>
<p>\(\text{l1_storage_write_cost}\) is the cost of writing to a new storage slot on Ethereum, which is 20,000 gas.</p>
</li>
<li>
<p>\(\text{log_message_to_l1_cost}\) is 1637 gas.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="#l_2-l_1_messages">L2&#8594;L1 messages</a>.</p>
</div>
</li>
<li>
<p>\(\text{l2_payload_costs}\) is the gas cost of data sent over L2. This includes calldata, code, and event emission. For more details see <a href="#l2_calldata">L2 payloads</a>.</p>
</li>
<li>
<p>\(\text{felt_size_in_bytes}\) is 32, which is the number of bytes required to encode a single STARK field element.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="overall_fee_calldata"><a class="anchor" href="#overall_fee_calldata"></a>Overall fee with calldata</h4>
<div class="paragraph">
<p>The following formula describes the overall fee, \(F\), for a transaction in blocks whose state diffs are sent to L1 as calldata:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
F  = gas\_price\cdot&amp;\Bigg(\max_k v_k w_k + \\
&amp; + \; \text{da_calldata_cost}\left(2(n-1)+2(m-1) + \ell + 2D + 3t + \sum\limits_{i=1}^t q_i\right)\\
&amp; - \; \text{contract_update_discount}\cdot (n-1) - 240 \\
&amp; + \;  \text{message_calldata_cost}\cdot 3t + (\text{message_calldata_cost} + \text{l1_log_data_cost})\cdot\sum\limits_{i=1}^t q_i \\
&amp; + \; \left(\text{l1_storage_write_cost}+\text{log_message_to_l1_cost}\right)\cdot t \\
&amp; + \; \text{l2_payload_costs}\Bigg)
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The following constants are defined in the same manner as in the blob-based formula:</p>
<div class="ulist">
<ul>
<li>
<p>\(v, w, n, m, t, \ell, D\)</p>
</li>
<li>
<p>\(\text{message_calldata_cost}, \; \text{l1_log_data_cost}, \; \text{log_message_to_l1_cost}, \; \text{l1_storage_write_cost}\)</p>
</li>
<li>
<p>\(\text{l2_payload_costs}\)</p>
</li>
</ul>
</div>
</li>
<li>
<p>\(\text{da_calldata_cost}\) is 551 gas per 32-byte word. This cost is derived as follows:</p>
<div class="ulist">
<ul>
<li>
<p>512 gas per 32-byte word for calldata.</p>
</li>
<li>
<p>~100 gas for onchain hashing that happens for every sent word.</p>
</li>
<li>
<p>a 10% discount, because the sequencer does not incur additional costs for repeated updates to the same storage slot within a single block.</p>
</li>
</ul>
</div>
</li>
<li>
<p>\(240\) is the gas discount for updating the sender&#8217;s balance, for the derivation of this number see <a href="#storage_updates">Storage updates</a>.</p>
</li>
<li>
<p>\(\text{contract_update_discount}\) is 312 gas, for the derivation of this discount see <a href="#storage_updates">Storage updates</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="calculation_of_gas_costs"><a class="anchor" href="#calculation_of_gas_costs"></a>Gas</h3>
<div class="paragraph">
<p>Every 60 seconds, Starknet samples the base price of gas and data gas on L1.</p>
</div>
<div class="paragraph">
<p>The price of gas on Starknet is set to the average of the last 60 gas price samples, plus 1 gwei.</p>
</div>
<div class="paragraph">
<p>The price of data gas on Starknet is set to the average of the last 60 data gas price samples. The data gas price on Ethereum is derived from the value of <code>excess_blob_gas</code>. For more information, see <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-4844.md">EIP-4844</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="computation"><a class="anchor" href="#computation"></a>Computation</h3>
<div class="sect3">
<h4 id="computation_without_builtins"><a class="anchor" href="#computation_without_builtins"></a>Without builtins</h4>
<div class="paragraph">
<p>Let&#8217;s analyze the correct metric for measuring transaction complexity. For simplicity, we will ignore Cairo&#8217;s builtins, and address them later.</p>
</div>
<div class="paragraph">
<p>A Cairo program execution yields an execution trace. When proving a Starknet block, we aggregate all the transactions appearing in that block to the execution trace.</p>
</div>
<div class="paragraph">
<p>Starknet&#8217;s prover generates proofs for execution traces, up to some maximal length \(L\), derived from the specs of the proving machine and the desired proof latency.</p>
</div>
<div class="paragraph">
<p>Tracking the execution trace length associated with each transaction is simple.
Each assertion over field elements, such as verifying addition/multiplication over the field, requires the same, constant number of trace cells, which is where our "no-builtins" assumption kicks in: Pedersen occupies more trace cells than addition. Therefore, in a world without builtins, the fee of the transaction \(tx\) is correlated with \(\text{TraceCells}[tx]/L\).</p>
</div>
</div>
<div class="sect3">
<h4 id="computation_with_builtins"><a class="anchor" href="#computation_with_builtins"></a>With builtins</h4>
<div class="paragraph">
<p>In the Cairo execution trace each builtin has its own slot, which is important to consider when determining the fee.</p>
</div>
<div class="paragraph">
<p>For example, consider that the prover can process a trace with the following limits:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">up to 500,000,000 Cairo Steps</th>
<th class="tableblock halign-left valign-top">up to 20,000,000 Pedersen hashes</th>
<th class="tableblock halign-left valign-top">up to 4,000,000 signature verifications</th>
<th class="tableblock halign-left valign-top">up to 10,000,000 range checks</th>
</tr>
</thead>
</table>
<div class="paragraph">
<p>The proof is closed and sent to L1 when any of these slots is filled.</p>
</div>
<div class="paragraph">
<p>Suppose that a transaction uses 10,000 Cairo steps and 500 Pedersen hashes. At most 40,000 such transactions can fit into the hypothetical trace (20,000,000/500). Therefore, its gas price correlates with 1/40,000 of the cost of submitting proof.</p>
</div>
<div class="paragraph">
<p>Notice that this estimate ignores the number of Cairo steps, as it is not the limiting factor, since 500,000,000/10,000 &gt; 20,000,000/500.</p>
</div>
<div class="paragraph">
<p>With this example in mind, it is possible to formulate the exact fee associated with L2 computation.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The allocation of resources among builtin operations must be predetermined; it is not possible to decide, post-execution, to include only 20,000,001 Pedersen hashes without additional components.</p>
</div>
<div class="paragraph">
<p>This safeguards fairness and prevents manipulation, ensuring integrity in proof generation and fee determination.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="calculation_of_computation_costs"><a class="anchor" href="#calculation_of_computation_costs"></a>Overall</h4>
<div class="paragraph">
<p>For each transaction, the sequencer calculates a vector, <code>CairoResourceUsage</code>, that contains the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of Cairo steps.</p>
</li>
<li>
<p>The number of applications of each Cairo builtin. For example, five range checks and two Pedersen hashes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The sequencer crosses this information with the <code>CairoResourceFeeWeights</code> vector. For each resource type, either a Cairo step or a specific builtin application, <code>CairoResourceFeeWeights</code> has an entry that specifies the relative gas cost of that component in the proof.</p>
</div>
<div class="paragraph">
<p>Going back to the above example, if the cost of submitting a proof with 20,000,000 Pedersen hashes is roughly 5m gas, then the weight of the Pedersen builtin is 0.25 gas per application (5,000,000/20,000,000). The sequencer has a predefined weights vector, in accordance with the proof parameters.</p>
</div>
<div class="paragraph">
<p>The sequencer charges only according to the limiting factor. Therefore the fee is correlated with:</p>
</div>
<div class="stemblock">
<div class="content">
\[\max_k[\text{CairoResourceUsage}_k \cdot \text{CairoResourceFeeWeights}_k]\]
</div>
</div>
<div class="paragraph">
<p>where \(k\) enumerates the Cairo resource components, that is the number of Cairo steps and builtins used.</p>
</div>
<div class="paragraph">
<p>The weights are listed in the following table:</p>
</div>
<table id="gas_cost_per_cairo_step_or_builtin_step" class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Gas cost</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cairo step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0025 gas/step</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pedersen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.08 gas/application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Poseidon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.08 gas/application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Range check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.04 gas/application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.12 gas/application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keccak</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.12 gas/application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitwise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.16 gas/application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EC_OP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.56 gas/application</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="onchain_data_components"><a class="anchor" href="#onchain_data_components"></a>Onchain data</h3>
<div class="paragraph">
<p>The onchain data associated with a transaction is composed of three parts</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Storage updates</p>
</li>
<li>
<p>L2→L1 messages</p>
</li>
<li>
<p>Deployed contracts</p>
</li>
<li>
<p>Declared classes (only relevant for <code>DECLARE</code> transactions, and adds two additional words)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="storage_updates"><a class="anchor" href="#storage_updates"></a>Storage updates</h4>
<div class="paragraph">
<p>Whenever a transaction updates some value in the storage of some contract, the following data is sent to L1:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>two 32-byte words per contract</p>
</li>
<li>
<p>two 32-byte words for every updated storage value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information on the exact data and its construction, see <a href="../data-availability/#v0.11.0_format" class="xref page">Data availability</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the most recent value reaches L1. So the transaction&#8217;s fee only depends on the number of <em>unique</em> storage updates. If the same storage cell is updated multiple times within the transaction, the fee remains that of a single update.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following formula describes the storage update fee for a transaction:</p>
</div>
<div class="stemblock">
<div class="content">
\[\underbrace{\textit{gas_price}\left(\text{da_calldata_cost} \cdot 2(n-1) - \text{contract_update_discount}\cdot (n-1)\right)}_{\text{contract addresses +  new nonce and number of storage updates
}} \\

+ \\

\underbrace{\textit{gas_price} \cdot \left(\text{da_calldata_cost}(2(m-1))-240\right)}_{\text{storage updates}}\]
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(n\) is <a href="#storage_updates">the number of unique contracts updated</a>, which also includes changes to classes of existing contracts and contract deployments, even if the storage of the newly deployed contract is untouched. In other words, \(n\ge\ell\). Notice that \(n\ge 1\) always holds, because the fee token contract is always updated at the end of each transaction, in order to update the sequencer&#8217;s and the sender&#8217;s balances. The fee token contract update is not taken into account when computing the fee.</p>
</li>
<li>
<p>\(m\) is the number of values updated, not counting multiple updates for the same key. Notice that \(m\ge 1\) always holds, because the sequencer&#8217;s balance is updated at the end of each transaction. The sequencer&#8217;s balance update is not taken into account when computing the fee.</p>
</li>
<li>
<p>\(\text{contract_update_discount}\) is 312 gas, which is discounted for every updated contract. This discount is a result of the fact that out of the \(2n\) words caused by updating contracts, \(n\) words are short, including at most 6 non-zero bytes:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>three bytes for the nonce</p>
</li>
<li>
<p>two bytes for the number of storage updates</p>
</li>
<li>
<p>one byte for the class information flag</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Taking into account that zero bytes only cost 4 gas, the cost difference between a full 32-byte word, which does not contain zeros, and a word with only six non-zero bytes is \(32\cdot16-(6\cdot16+26\cdot4)=312\).</p>
</div>
</li>
<li>
<p>\(240\) is the gas discount for updating the sender&#8217;s balance, and is derived by assuming the balance requires at most 12 non-zero bytes, which is enough for 1.2B ETH or STRK, resulting in the following discount: \(512-(20\cdot4+12\cdot16)=240\).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Improvements to the above pessimistic estimation might be gradually implemented in future versions of Starknet.</p>
</div>
<div class="paragraph">
<p>For example, if different transactions within the same block update the same storage cell, there is no need to charge for both transactions, because only the last value reaches L1. In the future, Starknet might include a refund mechanism for such cases.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="l_2-l_1_messages"><a class="anchor" href="#l_2-l_1_messages"></a>L2&#8594;L1 messages</h4>
<div class="paragraph">
<p>When a transaction that raises the <code>send_message_to_l1</code> syscall is included in a state update, the following data reaches L1:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>L2 sender address</p>
</li>
<li>
<p>L1 destination address</p>
</li>
<li>
<p>Payload size</p>
</li>
<li>
<p>Payload (list of field elements)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Consequently, the gas cost associated with a single L2→L1 message is:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\text{MESSAGE_COST} = &amp; \; \text{message_calldata_cost}\cdot\left(3+\text{payload_size}\right) \; + \\
&amp; + \text{l1_log_data_cost}\cdot\text{payload_size} \; + \\
&amp; + \text{log_message_to_l1_cost} \; + \\
&amp; + \text{l1_storage_write_cost}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\text{message_calldata_cost}\) is 1124 gas. This is the sum of the 512 gas paid to the core contract on submitting the state update, and 612 gas paid for the submitting of the same word to the verifier contract (which incurs ~100 additional gas for hashing). That is, messages are sent to Ethereum twice.</p>
</li>
<li>
<p>\(\text{log_message_to_l1_cost}\) is 1637 gas. This is the fixed cost involved in emitting a <code>LogMessageToL1</code> event. This event has two topics and a data array, which adds two data words to the event, resulting in a total of \(375+2\cdot 375+2\cdot 256\) gas (log opcode cost, topic cost, and two data words cost).</p>
</li>
<li>
<p>\(\text{l1_log_data_cost}\) is 256 gas, which is paid for every payload element during the emission of the <code>LogMessageToL1</code> event.</p>
</li>
<li>
<p>\(\text{l1_storage_write_cost}\) is 20,000 gas per message which is paid in order to store the message hash on the Starknet core contract. This recording of the message is what later enables the intended L1 contract to consume the message.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deployed_contracts"><a class="anchor" href="#deployed_contracts"></a>Deployed contracts</h4>
<div class="paragraph">
<p>When a transaction that raises the <code>deploy</code> syscall is included in a state update, the following data reaches L1:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>contract address</p>
</li>
<li>
<p>number of storage updates and the new nonce</p>
</li>
<li>
<p>class hash</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first two elements are counted in the number of unique modified contracts, denoted by \(n\) throughout this page. So the only additional word comes from publishing the class hash, which adds 551 gas. For more information, see \(\text{da_calldata_cost}\) in the <a href="#overall_fee">final formula</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="l2_calldata"><a class="anchor" href="#l2_calldata"></a>L2 payloads</h3>
<div class="paragraph">
<p>As of Starknet v0.13.1 onwards, L2 data is taken into account during pricing. This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>calldata: this includes transaction calldata (in the case of <code>INVOKE</code> transactions or <code>L1_HANDLER</code>), constructor calldata (in the case of <code>DEPLOY_ACCOUNT</code> transactions), and signatures</p>
</li>
<li>
<p>events: data and keys of emitted events</p>
</li>
<li>
<p>ABI: classes abi in <code>DECLARE</code> transactions (relevant only for <code>DECLARE</code> transactions of version ≥ 2)</p>
</li>
<li>
<p>CASM bytecode (for all available <code>DECLARE</code> transactions, where in version ≥ 2 this refers to the compiled class)</p>
</li>
<li>
<p>Sierra bytecode (relevant only for <code>DECLARE</code> transactions of version ≥ 2)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The pricing of the above components in terms of L1 gas is given by the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Gas cost</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.256 gas/felt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.128 gas/felt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calldata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.128 gas/felt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CASM bytecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 gas/felt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sierra bytecode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 gas/felt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ABI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.032 gas/character</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../data-availability/">Data availability</a></span>
  <span class="next"><a href="../messaging-mechanism/">L1-L2 messaging mechanism</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js?new"></script>
<script async src="../../../_/js/vendor/highlight.js?new"></script>
<script async src="../../../_/js/vendor/tabs-block-behaviour.js?new"></script>
<script async src="../../../_/js/vendor/swagger-ui.js?new"></script>
<script async src="../../../_/js/vendor/component-versions.js?new"></script>
<script src="https://chatwith.tools/chatbot/04f9f1da-f9bd-46c1-a74d-b72cec2014ea.js" async=""></script>
<script src="../../../_/js/vendor/custom.js?new"></script>
<script async src="../../../_/js/vendor/tabs.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js"></script>
<script
    src="https://cdn.jsdelivr.net/npm/algoliasearch@4.14.3/dist/algoliasearch-lite.umd.js"
    integrity="sha256-dyJcbGuYfdzNfifkHxYVd/rzeR6SLLcDFYEidcybldM="
    crossorigin="anonymous"
></script>
<script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-recent-searches"></script>
<script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-query-suggestions"></script>

<script>
  const { createQuerySuggestionsPlugin } = window['@algolia/autocomplete-plugin-query-suggestions'];
  const { createLocalStorageRecentSearchesPlugin, search } = window['@algolia/autocomplete-plugin-recent-searches'];
  const { algoliasearch } = window;
  const { autocomplete, getAlgoliaResults, getAlgoliaFacets} = window["@algolia/autocomplete-js"]
</script>

<script>
  function createLocalStorageRecentlyViewedItems(params) {
      const {
        onReset,
        onSubmit,
        subscribe,
        ...plugin
      } = createLocalStorageRecentSearchesPlugin({
        ...params,
        search(params) {
          if (params.query) {
            return [];
          }

          return search(params);
        },
        transformSource({ source, onRemove, state }) {
          const transformedSource = params.transformSource
            ? params.transformSource({ source, onRemove, state })
            : source;

          return {
            ...transformedSource,
            getItemUrl({ item }) {
              return item.url;
            },
            templates: {
              ...transformedSource.templates,
              header({html}) {
                return (html`
                  <div>
                    <span class="aa-SourceHeaderTitle">Recently viewed</span>
                  </div>
                `);
              },
              item({ item, components, html }) {

               const removeRecentItem = (event) => {
                    event.preventDefault();
                    event.stopPropagation();
                    onRemove(item.id);
                }

                return (html`
                  <a class="aa-ItemLink" href=${item.url}>
                    <div class="aa-ItemContent">
                      <div class="aa-ItemIcon aa-ItemIcon--noBorder">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                          <path d="M12.516 6.984v5.25l4.5 2.672-0.75 1.266-5.25-3.188v-6h1.5zM12 20.016q3.281 0 5.648-2.367t2.367-5.648-2.367-5.648-5.648-2.367-5.648 2.367-2.367 5.648 2.367 5.648 5.648 2.367zM12 2.016q4.125 0 7.055 2.93t2.93 7.055-2.93 7.055-7.055 2.93-7.055-2.93-2.93-7.055 2.93-7.055 7.055-2.93z" />
                        </svg>
                      </div>
                      <div class="aa-ItemContentBody">
                        <div class="aa-ItemContentTitle">
                          ${components.Highlight({ attribute: 'title', hit: item })}
                        </div>
                      </div>
                    </div>
                    <div class="aa-ItemActions">
                      <button
                        class="aa-ItemActionButton aa-ItemActionButtonDanger"
                        title="Remove this search"
                        onclick=${event => removeRecentItem(event)}
                      >
                        <svg
                          viewBox="0 0 24 24"
                          width="18"
                          height="18"
                          fill="currentColor"
                        >
                          <path d="M18 7v13c0 0.276-0.111 0.525-0.293 0.707s-0.431 0.293-0.707 0.293h-10c-0.276 0-0.525-0.111-0.707-0.293s-0.293-0.431-0.293-0.707v-13zM17 5v-1c0-0.828-0.337-1.58-0.879-2.121s-1.293-0.879-2.121-0.879h-4c-0.828 0-1.58 0.337-2.121 0.879s-0.879 1.293-0.879 2.121v1h-4c-0.552 0-1 0.448-1 1s0.448 1 1 1h1v13c0 0.828 0.337 1.58 0.879 2.121s1.293 0.879 2.121 0.879h10c0.828 0 1.58-0.337 2.121-0.879s0.879-1.293 0.879-2.121v-13h1c0.552 0 1-0.448 1-1s-0.448-1-1-1zM9 5v-1c0-0.276 0.111-0.525 0.293-0.707s0.431-0.293 0.707-0.293h4c0.276 0 0.525 0.111 0.707 0.293s0.293 0.431 0.293 0.707v1zM9 11v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1zM13 11v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1z" />
                        </svg>
                      </button>
                    </div>
                  </a>
                `);
              }
            }
          };
        }
      });

      const { getAlgoliaSearchParams, ...data } = plugin.data;

      return {
        ...plugin,
        data
      };
    }
</script>

<script>
  function createMostPopularSearchesPlugin(){
    const popularSearchers = createQuerySuggestionsPlugin({
      searchClient,
      indexName: 'web_query_suggestions_dev',
      getSearchParams({ state }) {
        return { hitsPerPage: 3 };
      },
      transformSource({ source, onTapAhead }) {
        const onSelectSuggestion = (event, item) => {
          event.preventDefault();
          event.stopPropagation();
          onTapAhead(item)
        };

        return {
          ...source,
          templates: {
            ...source.templates,
            header({ state, html }) {
              if (state.query) {
                return null;
              }

              return (html`
                <div>
                  <span className="aa-SourceHeaderTitle">Popular searches</span>
                </div>
              `);
            },
            item({html, item}){


              return (html`
                <div class="aa-ItemWrapper" onclick=${event => onSelectSuggestion(event, item)}>
                  <div class="aa-ItemContent">
                    <div class="aa-ItemIcon aa-ItemIcon--noBorder">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                          <path d="M16.041 15.856c-0.034 0.026-0.067 0.055-0.099 0.087s-0.060 0.064-0.087 0.099c-1.258 1.213-2.969 1.958-4.855 1.958-1.933 0-3.682-0.782-4.95-2.050s-2.050-3.017-2.050-4.95 0.782-3.682 2.050-4.95 3.017-2.050 4.95-2.050 3.682 0.782 4.95 2.050 2.050 3.017 2.050 4.95c0 1.886-0.745 3.597-1.959 4.856zM21.707 20.293l-3.675-3.675c1.231-1.54 1.968-3.493 1.968-5.618 0-2.485-1.008-4.736-2.636-6.364s-3.879-2.636-6.364-2.636-4.736 1.008-6.364 2.636-2.636 3.879-2.636 6.364 1.008 4.736 2.636 6.364 3.879 2.636 6.364 2.636c2.125 0 4.078-0.737 5.618-1.968l3.675 3.675c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414z"></path>
                        </svg>
                    </div>
                    <div class="aa-ItemContentBody">
                        <div class="aa-ItemContentTitle">${item.query}</div>
                    </div>
                  </div>
                  <div class="aa-ItemActions">
                    <button class="aa-ItemActionButton" title=${`Fill query with "${item.query}"`}>
                        <svg viewBox="0 0 24 24" fill="currentColor">
                          <path d="M8 17v-7.586l8.293 8.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-8.293-8.293h7.586c0.552 0 1-0.448 1-1s-0.448-1-1-1h-10c-0.552 0-1 0.448-1 1v10c0 0.552 0.448 1 1 1s1-0.448 1-1z"></path>
                        </svg>
                    </button>
                  </div>
                </div>
              `)
            }
          },
          onSelect({event, item, setIsOpen, itemInputValue, setQuery, refresh, ...rest}) {
            setIsOpen(true);
          },
        };
      },
    })

    return popularSearchers
  }
</script>

<script>
    const appId = "VHYJO45TI4";
    const apiKey = "9d5f273e78238a8c505526e481c857f7";
    const searchClient = algoliasearch(appId, apiKey);
    const hitsPerPage = 20

    function getSources({ query, state }) {
        if (!query) {
          return [];
        }

        return [
          {
            sourceId: "docs",
            getItems() {
              return getAlgoliaResults({
                searchClient,
                queries: [
                  {
                    indexName: "starknet-docs-main",
                    query,
                    params: {
                      attributesToSnippet: ["title:8", "content:10"],
                      snippetEllipsisText: "…",
                      hitsPerPage,
                    }
                  }
                ]
              });
            },
            getItemUrl({ item }) {
              return `${item.url}`;
            },
            onSelect({ item }) {
              recentlyViewedItems.data.addItem({
                id: item.objectID,
                title: item.title || item.content,
                url: item.url
              });
            },
            templates: {
              header({html, items}) {
                if(items.length === 0){
                  return null
                }
                return (
                  html`<span class="aa-SourceHeaderTitle">Documentation</span>`
                );
              },
              item({ item: hit, components, html}) {
                return (html`
                    <a href=${hit.url} class="aa-ItemLink">
                      <div class="aa-ItemContent">
                        <div class="aa-ItemIcon aa-ItemIcon--noBorder">
                          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M19.5999 9.99999C19.5999 15.3019 15.3018 19.6 9.9999 19.6C4.69797 19.6 0.399902 15.3019 0.399902 9.99999C0.399902 4.69806 4.69797 0.399994 9.9999 0.399994C15.3018 0.399994 19.5999 4.69806 19.5999 9.99999ZM17.7961 10.2449C17.6667 14.4394 14.2258 17.8 9.9999 17.8C5.69208 17.8 2.1999 14.3078 2.1999 9.99999C2.1999 6.55187 4.43732 3.62632 7.53954 2.59597L6.31196 4.74422C5.92196 5.42673 6.03701 6.28582 6.59284 6.84165C7.12339 7.37219 7.9339 7.50372 8.60499 7.16818L8.81467 7.06334C8.89798 7.02168 8.98985 6.99999 9.083 6.99999H9.25807C9.48534 6.99999 9.69309 7.1284 9.79473 7.33167C9.87919 7.50058 9.87919 7.69941 9.79473 7.86832L9.76138 7.93502C9.68018 8.09741 9.51421 8.19999 9.33265 8.19999H8.73006C7.82327 8.19999 6.97648 8.65319 6.47348 9.40768L6.42091 9.48654C5.98984 10.1331 5.88144 10.9426 6.12719 11.6798C6.37831 12.4331 6.97335 13.0237 7.72395 13.2739C8.00786 13.3685 8.19971 13.635 8.19971 13.9298V15.1895C8.19971 15.9685 8.8312 16.6 9.61018 16.6C10.0387 16.6 10.4439 16.4052 10.7116 16.0706L12.6452 13.6536C12.8747 13.3667 12.9997 13.0103 12.9997 12.643C12.9997 12.2639 13.1533 11.8949 13.4236 11.6246C13.9704 11.0778 14.0636 10.2141 13.6307 9.56485L13.074 8.72974C13.0256 8.65709 12.9997 8.57174 12.9997 8.48444C12.9997 8.12003 13.4157 7.91201 13.7073 8.13066L14.1185 8.4391C14.4975 8.7233 15.0044 8.76847 15.4274 8.55695C15.6984 8.42147 16.0258 8.47464 16.2395 8.68826L17.7961 10.2449Z" fill="currentColor"/>
                          </svg>
                        </div>
                        <div class="aa-ItemContentBody">
                          <div class="aa-ItemContentTitle">
                            ${components.Highlight({ attribute: 'value', hit: hit['_snippetResult'].content })}
                          </div>
                          <div class="aa-ItemContentSubtitle">
                            ${components.Highlight({ attribute: 'value', hit: hit['_snippetResult'].title })}
                          </div>
                        </div>
                      </div>
                      <div class="aa-ItemActions">
                        <button
                          class="aa-ItemActionButton"
                          title="Visit this link"
                        >
                          <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.35103 3.1786C9.69424 3.53815 9.68099 4.10784 9.32144 4.45105L4.34632 9.20003H16.35C19.9122 9.20003 22.8 12.0878 22.8 15.65C22.8 19.2123 19.9122 22.1 16.35 22.1H12.9C12.403 22.1 12 21.6971 12 21.2C12 20.703 12.403 20.3 12.9 20.3H16.35C18.9181 20.3 21 18.2182 21 15.65C21 13.0819 18.9181 11 16.35 11H4.34632L9.32144 15.749C9.68099 16.0922 9.69424 16.6619 9.35103 17.0215C9.00783 17.381 8.43813 17.3943 8.07858 17.051L1.47858 10.751C1.30067 10.5812 1.20001 10.346 1.20001 10.1C1.20001 9.85407 1.30067 9.61883 1.47858 9.44901L8.07858 3.14901C8.43813 2.8058 9.00783 2.81905 9.35103 3.1786Z" fill="currentColor"/>
                          </svg>
                        </button>
                      </div>
                    </a>
                  `)
              },
              noResults({state, html}) {
                return (html`
                  No results for <bold>"${state.query}"</bold> 😕
                `);
              }
            }
          }
        ];
    };

    const recentlyViewedItems = createLocalStorageRecentlyViewedItems({
      key: "RECENTLY_VIEWED",
      limit: 5
    });

    const mostPopulerSearches = createMostPopularSearchesPlugin()

    autocomplete({
      container: "#autocomplete",
      placeholder: "Search",
      openOnFocus: true,
      detachedMediaQuery: "",
      getSources,
      plugins: [recentlyViewedItems, mostPopulerSearches],
    });
</script>

<script>
  const modalBreakpoint = 680;
  const modalClassname = 'aa-DetachedContainer--modal'

  function toggleAlgoliaModal(){
      const algoliaDetachedContainer = document.querySelector('.aa-DetachedContainer')
      if(!algoliaDetachedContainer){
        return
      }
      const documentWidth = document.documentElement.clientWidth;
      if(documentWidth >= modalBreakpoint){
        algoliaDetachedContainer.classList.add(modalClassname)
      }else {
        algoliaDetachedContainer.classList.remove(modalClassname)
      }
  }

  // Attaching the event listener function to window's resize event
  window.addEventListener("resize", toggleAlgoliaModal);

  // Calling the function for the first time
  toggleAlgoliaModal();

</script>
  </body>
</html>
